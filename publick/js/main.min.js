"use strict";class Note{constructor(e){this.noteString="",this._noteName="",this.fon="#fff",this.fixedIndex=0,this.date=e,this._searchIndex=0}get noteName(){return this._noteName}set noteName(e){e.length<1||(this._noteName=e)}get index(){return this._searchIndex}set index(e){this._searchIndex=e}}const indexAnim={bind:0,clear:1};let notes=[],range=new Range,noteObj={index:0},addNoteBtn=document.querySelector(".add-note-btn"),sidebar=document.querySelector(".sidebar"),noteMain=document.querySelector(".main-note"),noteMini=document.querySelector(".note-mini"),noteNameElem=document.querySelector(".form-note__name"),noteText=document.querySelector(".form-note__text"),actionsBtn=document.querySelector(".actions");function dateCorrection(e){return e<10?`0${e}`:e}function deleteListener(e){e.children[3].children[0].addEventListener("click",(t=>{t.stopPropagation(),deleteNoteEverywhere(e)}))}function noteCallListener(){document.querySelectorAll(".note-mini").forEach((e=>{e.addEventListener("click",binding)}))}function nameChange(){notes.find((e=>e.index==noteObj.index)).noteName=noteNameElem.value}function textChange(){notes.find((e=>e.index==noteObj.index)).noteString=noteText.innerHTML}function comeInSight(e){switch(e){case 0:noteMain.classList.remove("_come-out-sight"),noteMain.classList.add("_come-in-sight");break;case 1:noteMain.classList.remove("_come-in-sight"),noteMain.classList.add("_come-out-sight")}}function clearFocus(){document.querySelectorAll(".note-mini").forEach((e=>{e.classList.contains("_active-note-min")&&e.classList.remove("_active-note-min")}))}function binding(){clearFocus(),this.classList.add("_active-note-min");let e=notes.find((e=>e.index==this.children[2].textContent));noteNameElem.value=e.noteName,noteText.innerHTML=e.noteString,noteObj.index=e.index,comeInSight(indexAnim.bind)}function deleteNoteEverywhere(e){let t=notes.findIndex((t=>{if(e.children[2].textContent==t.index)return!0}));-1!=t&&(clearNote(e.children[2].textContent),notes.splice(t,1),e.remove(),updateIndex())}function clearNote(e){e==noteObj.index&&(noteNameElem.value="",noteText.innerHTML="",comeInSight(indexAnim.clear))}function updateIndex(){let e=document.querySelectorAll(".note-mini");notes.forEach(((t,n)=>{e.forEach((e=>{e.children[2].textContent==t.index&&(e.children[2].textContent=n)})),t.index==noteObj.index&&(noteObj.index=n),t.index=n}))}function deligate(e){return document.execCommand(e,!1,null),noteText.focus(),!1}noteMini.remove(),addNoteBtn.addEventListener("click",(()=>{for(let e of notes)if(""==e.noteName)return;let e=new Date,t=new Note(`${dateCorrection(e.getDate())}.${dateCorrection(e.getMonth()+1)}`);t=new Proxy(t,{set(e,t,n){if("noteName"==t){document.querySelectorAll(".note-mini").forEach((t=>{t.children[2].textContent==e.index&&(t.children[0].textContent=n)}))}return e[t]=n,!0}}),t.index=notes.length,noteObj.index=t.index,notes.push(t);let n=noteMini.cloneNode(!0);n.children[0].textContent=t.noteName,n.children[1].textContent=t.date,n.children[2].textContent=t.index,sidebar.append(n),deleteListener(n),noteCallListener(),binding.call(n)})),noteNameElem.addEventListener("input",(()=>{nameChange()})),noteText.addEventListener("input",(()=>{textChange()})),actionsBtn.addEventListener("click",(e=>{let t=e.target;switch("A"==t.tagName?t=t.children[0].id:"IMG"==t.tagName&&(t=t.id),t){case"icon-b":deligate("bold");break;case"icone-italics":deligate("italic");break;case"icon-list":deligate("insertUnorderedList");break;case"icon-paper":case"icon-t-shirt":case"icon-office":break;case"icon-cross":comeInSight(indexAnim.clear),clearFocus()}}));